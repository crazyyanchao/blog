---
title: 基于图数据的组织机构聚类分析
tags: [ONgDB,图算法,算法,Spark,MySQL,Elasticsearch]
author: Yc-Ma
show_author_profile: true
key: 2020-11-16-基于图数据的组织机构聚类分析
pageview: true
---

Here's the table of contents:
1. TOC
{:toc}

## 背景
与组织机构相关的图谱中，公司主体的唯一性识别一般方法都是使用名称相似度和社会统一信用代码鉴别唯一主体。这种方法由于数据规范不同或者缺失必要的维度数据，识别准确率并不高。例如公司改名之后，就很难用名称直接去分析同一家主体，还有缺少字段数据的组织机构也无法直接用社会统一信用代码关联。因此，为了解决这个问题借助图数据对组织机构进行多维度相似性分析。

## 技术架构
从MySQL加载数据到ONgDB，使用Spark计算相似度【ONgDB集成Spark组件】，计算结果存储到Elasticsearch。通过阈值【值定义使用经验和实验值】过滤出和一个主体相似的其它主体，其结果为同一主体。主体的属性通过时间排序以及选举产生。
- 【具体选举策略：主体最新名称+时间序列的数据错位填充和选举补全数据】
- 主体最新名称关联的属性会有更新和值缺失问题，通过一个选举算法生成最终的主数据

## 数据格式化
因为数据涉及的有中文和英文以及数字，所以在从MySQL加载数据到ONgDB的时候，对所有涉及的数据进行格式化操作降低误差。
- 提取英文中文、大写转为小写、繁体转为简体【RETURN olab.string.matchCnEnRinse('國際生打撒3.$#%@#$GuangDong Rongjun Co') AS value】
- 提取数字【RETURN REPLACE(olab.replace.regexp('0755-255大萨达所16998, 28181666','[^0-9]'),' ','')】
- https://github.com/ongdb-contrib/ongdb-lab-apoc

## 图数据建模
### 唯一索引
```
CREATE CONSTRAINT ON (n:PREPCODE) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE公司中文名称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE中文简称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE中文拼音简称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE英文名称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE英文简称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE统一社会信用代码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE日期) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE地理位置) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE电子邮箱) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE网址) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE人物) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE电话) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE传真) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE营业执照号码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE国税登记号码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE地税登记号码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE公司注册号) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE纳税人识别号) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE交易代码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE其它关联组织机构) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE邮编) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE上市公司代码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE组织机构代码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE公司简介) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE主营业务) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE公司英文简介) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE经营范围) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE经营范围英文) ASSERT n.name IS UNIQUE;
```

### 更新时间
主体唯一ID加更新时间【方便数据监控】【数据变化之后重新计算相似度】
```
CREATE INDEX ON :PREPCODE(hupdatetime);
CREATE INDEX ON :PRE公司中文名称(hupdatetime);
CREATE INDEX ON :PRE中文简称(hupdatetime);
CREATE INDEX ON :PRE中文拼音简称(hupdatetime);
CREATE INDEX ON :PRE英文名称(hupdatetime);
CREATE INDEX ON :PRE英文简称(hupdatetime);
CREATE INDEX ON :PRE统一社会信用代码(hupdatetime);
CREATE INDEX ON :PRE日期(hupdatetime);
CREATE INDEX ON :PRE地理位置(hupdatetime);
CREATE INDEX ON :PRE电子邮箱(hupdatetime);
CREATE INDEX ON :PRE网址(hupdatetime);
CREATE INDEX ON :PRE人物(hupdatetime);
CREATE INDEX ON :PRE电话(hupdatetime);
CREATE INDEX ON :PRE传真(hupdatetime);
CREATE INDEX ON :PRE营业执照号码(hupdatetime);
CREATE INDEX ON :PRE国税登记号码(hupdatetime);
CREATE INDEX ON :PRE地税登记号码(hupdatetime);
CREATE INDEX ON :PRE公司注册号(hupdatetime);
CREATE INDEX ON :PRE纳税人识别号(hupdatetime);
CREATE INDEX ON :PRE交易代码(hupdatetime);
CREATE INDEX ON :PRE其它关联组织机构(hupdatetime);
CREATE INDEX ON :PRE邮编(hupdatetime);
CREATE INDEX ON :PRE上市公司代码(hupdatetime);
CREATE INDEX ON :PRE组织机构代码(hupdatetime);
CREATE INDEX ON :PRE公司简介(hupdatetime);
CREATE INDEX ON :PRE主营业务(hupdatetime);
CREATE INDEX ON :PRE公司英文简介(hupdatetime);
CREATE INDEX ON :PRE经营范围(hupdatetime);
CREATE INDEX ON :PRE经营范围英文(hupdatetime);
```

### 数据模型
- PREPCODE指向其它属性，同理构建其它数据模型
- 纯文本数据计算simhash值之后保存
```
(from:PREPCODE)-[r:中文名称]->(to:PRE公司中文名称)
(from:PREPCODE)-[r:中文简称]->(to:PRE中文简称)
(from:PREPCODE)-[r:中文拼音简称]->(to:PRE中文拼音简称)
(from:PREPCODE)-[r:英文名称]->(to:PRE英文名称)
(from:PREPCODE)-[r:英文简称]->(to:PRE英文简称)
(from:PREPCODE)-[r:统一社会信用代码]->(to:PRE统一社会信用代码)
(from:PREPCODE)-[r:成立日期]->(to:PRE日期)
(from:PREPCODE)-[r:存续起始日]->(to:PRE日期)
(from:PREPCODE)-[r:存续截止日]->(to:PRE日期)
(from:PREPCODE)-[r:注册地址]->(to:PRE地理位置)
(from:PREPCODE)-[r:注册所在省市]->(to:PRE地理位置)
(from:PREPCODE)-[r:注册所在区县]->(to:PRE地理位置)
(from:PREPCODE)-[r:注册地址邮编]->(to:PRE地理位置)
(from:PREPCODE)-[r:办公地址]->(to:PRE地理位置)
(from:PREPCODE)-[r:联系地址]->(to:PRE地理位置)
(from:PREPCODE)-[r:联系地址邮编]->(to:PRE地理位置)
(from:PREPCODE)-[r:联系所在省市]->(to:PRE地理位置)
(from:PREPCODE)-[r:省份]->(to:PRE地理位置)
(from:PREPCODE)-[r:市县代码]->(to:PRE地理位置)
(from:PREPCODE)-[r:市县]->(to:PRE地理位置)
(from:PREPCODE)-[r:电子邮箱]->(to:PRE电子邮箱)
(from:PREPCODE)-[r:董秘邮箱]->(to:PRE电子邮箱)
(from:PREPCODE)-[r:证券代表电子邮箱]->(to:PRE电子邮箱)
(from:PREPCODE)-[r:网址]->(to:PRE网址)
(from:PREPCODE)-[r:电话]->(to:PRE电话)
(from:PREPCODE)-[r:联系电话]->(to:PRE电话)
(from:PREPCODE)-[r:董秘电话]->(to:PRE电话)
(from:PREPCODE)-[r:证券代表电话]->(to:PRE电话)
(from:PREPCODE)-[r:客服电话]->(to:PRE电话)
(from:PREPCODE)-[r:传真]->(to:PRE传真)
(from:PREPCODE)-[r:董秘传真]->(to:PRE传真)
(from:PREPCODE)-[r:证券代表传真]->(to:PRE传真)
(from:PREPCODE)-[r:客服传真]->(to:PRE传真)
(from:PREPCODE)-[r:营业执照号码]->(to:PRE营业执照号码)
(from:PREPCODE)-[r:国税登记号码]->(to:PRE国税登记号码)
(from:PREPCODE)-[r:地税登记号码]->(to:PRE地税登记号码)
(from:PREPCODE)-[r:公司注册号]->(to:PRE公司注册号)
(from:PREPCODE)-[r:纳税人识别号]->(to:PRE纳税人识别号)
(from:PREPCODE)-[r:交易代码]->(to:PRE交易代码)
(from:PREPCODE)-[r:其它关联组织机构]->(to:PRE其它关联组织机构)
(from:PREPCODE)-[r:邮编]->(to:PRE邮编)
(from:PREPCODE)-[r:上市公司代码]->(to:PRE上市公司代码)
(from:PREPCODE)-[r:组织机构代码]->(to:PRE组织机构代码)
(from:PREPCODE)-[r:律师事务所]->(to:PRE其它关联组织机构)
(from:PREPCODE)-[r:会计师事务所]->(to:PRE其它关联组织机构)
(from:PREPCODE)-[r:资产评估机构]->(to:PRE其它关联组织机构)
(from:PREPCODE)-[r:法人代表]->(to:PRE人物)
(from:PREPCODE)-[r:总经理]->(to:PRE人物)
(from:PREPCODE)-[r:律师]->(to:PRE人物)
(from:PREPCODE)-[r:会计师]->(to:PRE人物)
(from:PREPCODE)-[r:评估师]->(to:PRE人物)
(from:PREPCODE)-[r:基金管理人名称]->(to:PRE人物)
(from:PREPCODE)-[r:基金托管人名称]->(to:PRE人物)
(from:PREPCODE)-[r:其它负责人]->(to:PRE人物)
(from:PREPCODE)-[r:联系人]->(to:PRE人物)
(from:PREPCODE)-[r:董事长]->(to:PRE人物)
(from:PREPCODE)-[r:董秘]->(to:PRE人物)
(from:PREPCODE)-[r:证券股证事务代表]->(to:PRE人物)
(from:PREPCODE)-[r:董秘授权代表]->(to:PRE人物)
(from:PREPCODE)-[r:董秘授权代表]->(to:PRE人物)
(from:PREPCODE)-[r:公司简介]->(to:PRE公司简介)
(from:PREPCODE)-[r:主营业务]->(to:PRE主营业务)
(from:PREPCODE)-[r:公司英文简介]->(to:PRE公司英文简介)
(from:PREPCODE)-[r:经营范围]->(to:PRE经营范围)
(from:PREPCODE)-[r:经营范围英文]->(to:PRE经营范围英文)
```

### JDBC LOAD CYPHER
构建样例【一】【(from:PREPCODE)-[r:中文名称]->(to:PRE公司中文名称)】
#### 节点
- PREPCODE
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')','MERGE (n:PREPCODE {name:row.name}) SET n+=row', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE公司中文名称
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT name_cn AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')','WITH olab.string.matchCnEnRinse(row.name) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司中文名称 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE中文简称
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT name_cn AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')','WITH olab.string.matchCnEnRinse(row.name) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司中文名称 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE中文拼音简称
- PRE英文名称
- PRE英文简称
- PRE统一社会信用代码
- PRE日期
- PRE地理位置
- PRE电子邮箱
- PRE网址
- PRE人物
- PRE电话
- PRE传真
- PRE营业执照号码
- PRE国税登记号码
- PRE地税登记号码
- PRE公司注册号
- PRE纳税人识别号
- PRE交易代码
- PRE其它关联组织机构
- PRE邮编
- PRE上市公司代码
- PRE组织机构代码
- PRE公司简介
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT brief_intro_text AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE主营业务
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT business_major AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE公司英文简介
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT brief_intro_text_en AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE经营范围
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT biz_scope AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE经营范围英文
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT biz_scope_en AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

#### 关系
- (from:PREPCODE)-[r:中文名称]->(to:PRE公司中文名称)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/analytics_graph_data?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,name_cn AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE公司中文名称 {name:row.to}) MERGE (from)-[:中文名称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:中文简称]->(to:PRE中文简称)
- (from:PREPCODE)-[r:中文拼音简称]->(to:PRE中文拼音简称)
- (from:PREPCODE)-[r:英文名称]->(to:PRE英文名称)
- (from:PREPCODE)-[r:英文简称]->(to:PRE英文简称)
- (from:PREPCODE)-[r:统一社会信用代码]->(to:PRE统一社会信用代码)
- (from:PREPCODE)-[r:成立日期]->(to:PRE日期)
- (from:PREPCODE)-[r:存续起始日]->(to:PRE日期)
- (from:PREPCODE)-[r:存续截止日]->(to:PRE日期)
- (from:PREPCODE)-[r:注册地址]->(to:PRE地理位置)
- (from:PREPCODE)-[r:注册所在省市]->(to:PRE地理位置)
- (from:PREPCODE)-[r:注册所在区县]->(to:PRE地理位置)
- (from:PREPCODE)-[r:注册地址邮编]->(to:PRE地理位置)
- (from:PREPCODE)-[r:办公地址]->(to:PRE地理位置)
- (from:PREPCODE)-[r:联系地址]->(to:PRE地理位置)
- (from:PREPCODE)-[r:联系地址邮编]->(to:PRE地理位置)
- (from:PREPCODE)-[r:联系所在省市]->(to:PRE地理位置)
- (from:PREPCODE)-[r:省份]->(to:PRE地理位置)
- (from:PREPCODE)-[r:市县代码]->(to:PRE地理位置)
- (from:PREPCODE)-[r:市县]->(to:PRE地理位置)
- (from:PREPCODE)-[r:电子邮箱]->(to:PRE电子邮箱)
- (from:PREPCODE)-[r:董秘邮箱]->(to:PRE电子邮箱)
- (from:PREPCODE)-[r:证券代表电子邮箱]->(to:PRE电子邮箱)
- (from:PREPCODE)-[r:网址]->(to:PRE网址)
- (from:PREPCODE)-[r:电话]->(to:PRE电话)
- (from:PREPCODE)-[r:联系电话]->(to:PRE电话)
- (from:PREPCODE)-[r:董秘电话]->(to:PRE电话)
- (from:PREPCODE)-[r:证券代表电话]->(to:PRE电话)
- (from:PREPCODE)-[r:客服电话]->(to:PRE电话)
- (from:PREPCODE)-[r:传真]->(to:PRE传真)
- (from:PREPCODE)-[r:董秘传真]->(to:PRE传真)
- (from:PREPCODE)-[r:证券代表传真]->(to:PRE传真)
- (from:PREPCODE)-[r:客服传真]->(to:PRE传真)
- (from:PREPCODE)-[r:营业执照号码]->(to:PRE营业执照号码)
- (from:PREPCODE)-[r:国税登记号码]->(to:PRE国税登记号码)
- (from:PREPCODE)-[r:地税登记号码]->(to:PRE地税登记号码)
- (from:PREPCODE)-[r:公司注册号]->(to:PRE公司注册号)
- (from:PREPCODE)-[r:纳税人识别号]->(to:PRE纳税人识别号)
- (from:PREPCODE)-[r:交易代码]->(to:PRE交易代码)
- (from:PREPCODE)-[r:其它关联组织机构]->(to:PRE其它关联组织机构)
- (from:PREPCODE)-[r:邮编]->(to:PRE邮编)
- (from:PREPCODE)-[r:上市公司代码]->(to:PRE上市公司代码)
- (from:PREPCODE)-[r:组织机构代码]->(to:PRE组织机构代码)
- (from:PREPCODE)-[r:律师事务所]->(to:PRE其它关联组织机构)
- (from:PREPCODE)-[r:会计师事务所]->(to:PRE其它关联组织机构)
- (from:PREPCODE)-[r:资产评估机构]->(to:PRE其它关联组织机构)
- (from:PREPCODE)-[r:法人代表]->(to:PRE人物)
- (from:PREPCODE)-[r:总经理]->(to:PRE人物)
- (from:PREPCODE)-[r:律师]->(to:PRE人物)
- (from:PREPCODE)-[r:会计师]->(to:PRE人物)
- (from:PREPCODE)-[r:评估师]->(to:PRE人物)
- (from:PREPCODE)-[r:基金管理人名称]->(to:PRE人物)
- (from:PREPCODE)-[r:基金托管人名称]->(to:PRE人物)
- (from:PREPCODE)-[r:其它负责人]->(to:PRE人物)
- (from:PREPCODE)-[r:联系人]->(to:PRE人物)
- (from:PREPCODE)-[r:董事长]->(to:PRE人物)
- (from:PREPCODE)-[r:董秘]->(to:PRE人物)
- (from:PREPCODE)-[r:证券股证事务代表]->(to:PRE人物)
- (from:PREPCODE)-[r:董秘授权代表]->(to:PRE人物)
- (from:PREPCODE)-[r:董秘授权代表]->(to:PRE人物)
- (from:PREPCODE)-[r:公司简介]->(to:PRE公司简介)
- (from:PREPCODE)-[r:主营业务]->(to:PRE主营业务)
- (from:PREPCODE)-[r:公司英文简介]->(to:PRE公司英文简介)
- (from:PREPCODE)-[r:经营范围]->(to:PRE经营范围)
- (from:PREPCODE)-[r:经营范围英文]->(to:PRE经营范围英文)

## Spark相似性计算
### 阈值设置

### 计算方式

### 计算结果保存到Elasticsearch
```

```

## 使用CYPHER查询某个公司主体的聚簇
使用阈值过滤Elasticsearch查询出同一家主体，通过pcode关联出数据网络
```

```

