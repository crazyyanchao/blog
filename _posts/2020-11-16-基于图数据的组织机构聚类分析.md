---
title: 基于图数据的组织机构聚类分析
tags: [ONgDB,图算法,算法,Spark,MySQL,Elasticsearch,Neo4j]
author: Yc-Ma
show_author_profile: true
key: 2020-11-16-基于图数据的组织机构聚类分析
pageview: true
---

Here's the table of contents:
1. TOC
{:toc}

## 背景
与组织机构相关的图谱中，公司主体的唯一性识别一般方法都是使用名称相似度和社会统一信用代码鉴别唯一主体。这种方法由于数据规范不同或者缺失必要的维度数据，识别准确率并不高。例如公司改名之后，就很难用名称直接去分析同一家主体，还有缺少字段数据的组织机构也无法直接用社会统一信用代码关联。因此，为了解决这个问题借助图数据对组织机构进行多维度相似性分析。

## 技术架构
从MySQL加载数据到ONgDB，使用Spark计算相似度【ONgDB集成Spark组件】，计算结果存储到Elasticsearch。通过阈值【值定义使用经验和实验值】过滤出和一个主体相似的其它主体，其结果为同一主体。主体的属性通过时间排序以及选举产生。
- 【具体选举策略：主体最新名称+时间序列的数据错位填充和选举补全数据】
- 主体最新名称关联的属性会有更新和值缺失问题，通过一个选举算法生成最终的主数据

## 数据格式化
因为数据涉及的有中文和英文以及数字，所以在从MySQL加载数据到ONgDB的时候，对所有涉及的数据进行格式化操作降低误差。
- 提取英文中文、大写转为小写、繁体转为简体【RETURN olab.string.matchCnEnRinse('國際生打撒3.$#%@#$GuangDong Rongjun Co') AS value】
- 提取数字【RETURN REPLACE(olab.replace.regexp('0755-255大萨达所16998, 28181666','[^0-9]'),' ','')】
- 【ONgDB图数据库存储过程插件下载】https://github.com/ongdb-contrib/ongdb-lab-apoc

## 图数据建模
### 唯一索引
```
CREATE CONSTRAINT ON (n:PREPCODE) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE公司中文名称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE中文简称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE中文拼音简称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE英文名称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE英文简称) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE统一社会信用代码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE日期) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE地理位置) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE电子邮箱) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE网址) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE人物) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE电话) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE传真) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE营业执照号码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE国税登记号码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE地税登记号码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE公司注册号) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE纳税人识别号) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE交易代码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE其它关联组织机构) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE邮编) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE上市公司代码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE组织机构代码) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE公司简介) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE主营业务) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE公司英文简介) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE经营范围) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE经营范围英文) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE曾用名) ASSERT n.name IS UNIQUE;
CREATE CONSTRAINT ON (n:PRE证券名称) ASSERT n.name IS UNIQUE;
```

### 更新时间
主体唯一ID加更新时间【方便数据监控】【数据变化之后重新计算相似度】
```
CREATE INDEX ON :PREPCODE(hupdatetime);
CREATE INDEX ON :PRE公司中文名称(hupdatetime);
CREATE INDEX ON :PRE中文简称(hupdatetime);
CREATE INDEX ON :PRE中文拼音简称(hupdatetime);
CREATE INDEX ON :PRE英文名称(hupdatetime);
CREATE INDEX ON :PRE英文简称(hupdatetime);
CREATE INDEX ON :PRE统一社会信用代码(hupdatetime);
CREATE INDEX ON :PRE日期(hupdatetime);
CREATE INDEX ON :PRE地理位置(hupdatetime);
CREATE INDEX ON :PRE电子邮箱(hupdatetime);
CREATE INDEX ON :PRE网址(hupdatetime);
CREATE INDEX ON :PRE人物(hupdatetime);
CREATE INDEX ON :PRE电话(hupdatetime);
CREATE INDEX ON :PRE传真(hupdatetime);
CREATE INDEX ON :PRE营业执照号码(hupdatetime);
CREATE INDEX ON :PRE国税登记号码(hupdatetime);
CREATE INDEX ON :PRE地税登记号码(hupdatetime);
CREATE INDEX ON :PRE公司注册号(hupdatetime);
CREATE INDEX ON :PRE纳税人识别号(hupdatetime);
CREATE INDEX ON :PRE交易代码(hupdatetime);
CREATE INDEX ON :PRE其它关联组织机构(hupdatetime);
CREATE INDEX ON :PRE邮编(hupdatetime);
CREATE INDEX ON :PRE上市公司代码(hupdatetime);
CREATE INDEX ON :PRE组织机构代码(hupdatetime);
CREATE INDEX ON :PRE公司简介(hupdatetime);
CREATE INDEX ON :PRE主营业务(hupdatetime);
CREATE INDEX ON :PRE公司英文简介(hupdatetime);
CREATE INDEX ON :PRE经营范围(hupdatetime);
CREATE INDEX ON :PRE经营范围英文(hupdatetime);
CREATE INDEX ON :PRE曾用名(hupdatetime);
CREATE INDEX ON :PRE证券名称(hupdatetime);
```

### 数据模型
- PREPCODE指向其它属性，同理构建其它数据模型
- 纯文本数据计算simhash值之后保存
```
(from:PREPCODE)-[r:中文名称]->(to:PRE公司中文名称)
(from:PREPCODE)-[r:中文简称]->(to:PRE中文简称)
(from:PREPCODE)-[r:中文拼音简称]->(to:PRE中文拼音简称)
(from:PREPCODE)-[r:英文名称]->(to:PRE英文名称)
(from:PREPCODE)-[r:英文简称]->(to:PRE英文简称)
(from:PREPCODE)-[r:统一社会信用代码]->(to:PRE统一社会信用代码)
(from:PREPCODE)-[r:成立日期]->(to:PRE日期)
(from:PREPCODE)-[r:存续起始日]->(to:PRE日期)
(from:PREPCODE)-[r:存续截止日]->(to:PRE日期)
(from:PREPCODE)-[r:注册地址]->(to:PRE地理位置)
(from:PREPCODE)-[r:注册所在省市]->(to:PRE地理位置)
(from:PREPCODE)-[r:注册所在区县]->(to:PRE地理位置)
(from:PREPCODE)-[r:注册地址邮编]->(to:PRE地理位置)
(from:PREPCODE)-[r:办公地址]->(to:PRE地理位置)
(from:PREPCODE)-[r:联系地址]->(to:PRE地理位置)
(from:PREPCODE)-[r:联系地址邮编]->(to:PRE地理位置)
(from:PREPCODE)-[r:联系所在省市]->(to:PRE地理位置)
(from:PREPCODE)-[r:省份]->(to:PRE地理位置)
(from:PREPCODE)-[r:市县代码]->(to:PRE地理位置)
(from:PREPCODE)-[r:市县]->(to:PRE地理位置)
(from:PREPCODE)-[r:电子邮箱]->(to:PRE电子邮箱)
(from:PREPCODE)-[r:董秘邮箱]->(to:PRE电子邮箱)
(from:PREPCODE)-[r:证券代表电子邮箱]->(to:PRE电子邮箱)
(from:PREPCODE)-[r:网址]->(to:PRE网址)
(from:PREPCODE)-[r:电话]->(to:PRE电话)
(from:PREPCODE)-[r:联系电话]->(to:PRE电话)
(from:PREPCODE)-[r:董秘电话]->(to:PRE电话)
(from:PREPCODE)-[r:证券代表电话]->(to:PRE电话)
(from:PREPCODE)-[r:客服电话]->(to:PRE电话)
(from:PREPCODE)-[r:传真]->(to:PRE传真)
(from:PREPCODE)-[r:董秘传真]->(to:PRE传真)
(from:PREPCODE)-[r:证券代表传真]->(to:PRE传真)
(from:PREPCODE)-[r:客服传真]->(to:PRE传真)
(from:PREPCODE)-[r:营业执照号码]->(to:PRE营业执照号码)
(from:PREPCODE)-[r:国税登记号码]->(to:PRE国税登记号码)
(from:PREPCODE)-[r:地税登记号码]->(to:PRE地税登记号码)
(from:PREPCODE)-[r:公司注册号]->(to:PRE公司注册号)
(from:PREPCODE)-[r:纳税人识别号]->(to:PRE纳税人识别号)
(from:PREPCODE)-[r:交易代码]->(to:PRE交易代码)
(from:PREPCODE)-[r:其它关联组织机构]->(to:PRE其它关联组织机构)
(from:PREPCODE)-[r:邮编]->(to:PRE邮编)
(from:PREPCODE)-[r:上市公司代码]->(to:PRE上市公司代码)
(from:PREPCODE)-[r:组织机构代码]->(to:PRE组织机构代码)
(from:PREPCODE)-[r:律师事务所]->(to:PRE其它关联组织机构)
(from:PREPCODE)-[r:会计师事务所]->(to:PRE其它关联组织机构)
(from:PREPCODE)-[r:资产评估机构]->(to:PRE其它关联组织机构)
(from:PREPCODE)-[r:法人代表]->(to:PRE人物)
(from:PREPCODE)-[r:总经理]->(to:PRE人物)
(from:PREPCODE)-[r:律师]->(to:PRE人物)
(from:PREPCODE)-[r:会计师]->(to:PRE人物)
(from:PREPCODE)-[r:评估师]->(to:PRE人物)
(from:PREPCODE)-[r:基金管理人名称]->(to:PRE人物)
(from:PREPCODE)-[r:基金托管人名称]->(to:PRE人物)
(from:PREPCODE)-[r:其它负责人]->(to:PRE人物)
(from:PREPCODE)-[r:联系人]->(to:PRE人物)
(from:PREPCODE)-[r:董事长]->(to:PRE人物)
(from:PREPCODE)-[r:董秘]->(to:PRE人物)
(from:PREPCODE)-[r:证券股证事务代表]->(to:PRE人物)
(from:PREPCODE)-[r:董秘授权代表]->(to:PRE人物)
(from:PREPCODE)-[r:董秘授权代表]->(to:PRE人物)
(from:PREPCODE)-[r:公司简介]->(to:PRE公司简介)
(from:PREPCODE)-[r:主营业务]->(to:PRE主营业务)
(from:PREPCODE)-[r:公司英文简介]->(to:PRE公司英文简介)
(from:PREPCODE)-[r:经营范围]->(to:PRE经营范围)
(from:PREPCODE)-[r:经营范围英文]->(to:PRE经营范围英文)
(from:PREPCODE)-[r:曾用名]->(to:PRE曾用名)
(from:PREPCODE)-[r:证券名称]->(to:PRE证券名称)
```

### JDBC LOAD CYPHER
#### 节点
- PREPCODE
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND hupdatetime>={hupdatetime}\')','MERGE (n:PREPCODE {name:row.name}) SET n+=row', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE公司中文名称
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT name_cn AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND name_cn IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.string.matchCnEnRinse(row.name) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司中文名称 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE中文简称
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT name_cn_thin AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND name_cn_thin IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.string.matchCnEnRinse(row.name) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE中文简称 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE中文拼音简称
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT name_cn_spelling AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND name_cn_spelling IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.string.matchCnEnRinse(row.name) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE中文拼音简称 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE英文名称
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT name_en AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND name_en IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH (row.name) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE英文名称 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE英文简称olab.string.matchCnEnRinse
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT name_en_thin AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND name_en_thin IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.string.matchCnEnRinse(row.name) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE英文简称 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE曾用名
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT previous_name AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND previous_name IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH apoc.convert.fromJsonList(row.name) AS oldNameList,row.hupdatetime AS hupdatetime UNWIND oldNameList AS oldName WITH olab.string.matchCnEnRinse(oldName) AS name,hupdatetime MERGE (n:PRE曾用名 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE证券名称
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT relevant_security AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND relevant_security IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH apoc.convert.fromJsonList(row.name) AS oldNameList,row.hupdatetime AS hupdatetime UNWIND oldNameList AS oldName WITH olab.string.matchCnEnRinse(oldName) AS name,hupdatetime MERGE (n:PRE证券名称 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE统一社会信用代码
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT credit_code AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND credit_code IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE统一社会信用代码 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE日期
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT establishment_date AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND establishment_date IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE日期 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT start_date AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND start_date IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE日期 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT close_date AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND close_date IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE日期 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE地理位置
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT reg_addr AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND reg_addr IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT reg_city AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND reg_city IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT reg_area AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND reg_area IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT reg_zip AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND reg_zip IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT office_addr AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND office_addr IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT contact_addr AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND contact_addr IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT contact_zip_code AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND contact_zip_code IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT contact_city AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND contact_city IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT province AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND province IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT county_code AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND county_code IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT county AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND county IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地理位置 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE电子邮箱
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT email AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND email IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE电子邮箱 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT bsecretary_email AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND bsecretary_email IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE电子邮箱 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT security_man_email AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND security_man_email IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE电子邮箱 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE网址
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT website AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND website IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE网址 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE人物
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT legal_person_repr AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND legal_person_repr IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT general_manager AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND general_manager IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT lawyer AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND lawyer IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT accountant AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND accountant IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT valuer AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND valuer IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT invest_advisor_name AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND invest_advisor_name IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT trustee_name AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND trustee_name IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT other_manager AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND other_manager IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT contactman AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND contactman IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT chairman AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND chairman IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT bsecretary AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND bsecretary IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT security_man AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND security_man IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT auth_represent AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND auth_represent IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE人物 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE电话
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT tel AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND tel IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE电话 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT bsecretary_tel AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND bsecretary_tel IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE电话 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT security_man_tel AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND security_man_tel IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE电话 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT service_tel AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND service_tel IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE电话 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT service_tel AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND service_tel IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE电话 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE传真
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT fax AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND fax IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE传真 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT bsecretary_fax AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND bsecretary_fax IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE传真 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT security_man_fax AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND security_man_fax IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE传真 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT service_fax AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND service_fax IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE传真 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE营业执照号码
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT biz_license_no AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND biz_license_no IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE营业执照号码 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE国税登记号码
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT tax_register_no AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND tax_register_no IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE国税登记号码 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE地税登记号码
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT land_register_no AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND land_register_no IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE地税登记号码 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE公司注册号
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT company_register_code AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND company_register_code IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司注册号 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE纳税人识别号
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT taxpayer_number AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND taxpayer_number IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE纳税人识别号 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE交易代码
- PRE其它关联组织机构
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT law_office AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND law_office IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE其它关联组织机构 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT accounting_firm AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND accounting_firm IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE其它关联组织机构 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT asset_evaluation_agency AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND asset_evaluation_agency IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE其它关联组织机构 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE邮编
- PRE上市公司代码
- PRE组织机构代码
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT organization_code AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND organization_code IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH row.name AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE组织机构代码 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

- PRE公司简介
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT brief_intro_text AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND brief_intro_text IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE主营业务
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT business_major AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND business_major IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE公司英文简介
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT brief_intro_text_en AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND brief_intro_text_en IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE经营范围
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT biz_scope AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND biz_scope IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- PRE经营范围英文
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT biz_scope_en AS `name`,CONVERT(DATE_FORMAT(hupdatetime,\\\'%Y%m%d%H%i%S\\\'),UNSIGNED INTEGER) AS hupdatetime FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND biz_scope_en IS NOT NULL AND hupdatetime>={hupdatetime}\')','WITH olab.simhash(olab.string.matchCnEnRinse(row.name)) AS name,row.hupdatetime AS hupdatetime MERGE (n:PRE公司简介 {name:name}) SET n.hupdatetime=hupdatetime', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```

#### 关系
- (from:PREPCODE)-[r:中文名称]->(to:PRE公司中文名称)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,name_cn AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND name_cn IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.string.matchCnEnRinse(row.to) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE公司中文名称 {name:toName}) MERGE (from)-[:中文名称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:中文简称]->(to:PRE中文简称)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,name_cn_thin AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND name_cn_thin IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.string.matchCnEnRinse(row.to) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE中文简称 {name:toName}) MERGE (from)-[:中文简称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:中文拼音简称]->(to:PRE中文拼音简称)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,name_cn_spelling AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND name_cn_spelling IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.string.matchCnEnRinse(row.to) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE中文拼音简称 {name:toName}) MERGE (from)-[:中文拼音简称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:英文名称]->(to:PRE英文名称)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,name_en AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND name_en IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.string.matchCnEnRinse(row.to) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE英文名称 {name:toName}) MERGE (from)-[:英文名称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:英文简称]->(to:PRE英文简称)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,name_en_thin AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND name_en_thin IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.string.matchCnEnRinse(row.to) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE英文简称 {name:toName}) MERGE (from)-[:英文简称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:统一社会信用代码]->(to:PRE统一社会信用代码)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,credit_code AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND credit_code IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE统一社会信用代码 {name:row.to}) MERGE (from)-[:统一社会信用代码]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:成立日期]->(to:PRE日期)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,establishment_date AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND establishment_date IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE日期 {name:toName}) MERGE (from)-[:成立日期]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:存续起始日]->(to:PRE日期)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,start_date AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND start_date IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE日期 {name:toName}) MERGE (from)-[:存续起始日]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:存续截止日]->(to:PRE日期)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,close_date AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND close_date IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE日期 {name:toName}) MERGE (from)-[:存续截止日]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:注册地址]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,reg_addr AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND reg_addr IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:注册地址]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:注册所在省市]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,reg_city AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND reg_city IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:注册所在省市]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:注册所在区县]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,reg_area AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND reg_area IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:注册所在区县]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:注册地址邮编]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,reg_zip AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND reg_zip IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:注册地址邮编]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:办公地址]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,office_addr AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND office_addr IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:办公地址]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:联系地址]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,contact_addr AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND contact_addr IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:联系地址]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:联系地址邮编]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,contact_zip_code AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND contact_zip_code IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:联系地址邮编]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:联系所在省市]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,contact_city AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND contact_city IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:联系所在省市]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:省份]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,province AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND province IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:省份]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:市县代码]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,county_code AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND county_code IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:市县代码]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:市县]->(to:PRE地理位置)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,county AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND county IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地理位置 {name:row.to}) MERGE (from)-[:市县]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:电子邮箱]->(to:PRE电子邮箱)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,email AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND email IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE电子邮箱 {name:row.to}) MERGE (from)-[:电子邮箱]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:董秘邮箱]->(to:PRE电子邮箱)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,bsecretary_email AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND bsecretary_email IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE电子邮箱 {name:row.to}) MERGE (from)-[:董秘邮箱]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:证券代表电子邮箱]->(to:PRE电子邮箱)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,security_man_email AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND security_man_email IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE电子邮箱 {name:row.to}) MERGE (from)-[:证券代表电子邮箱]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:网址]->(to:PRE网址)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,website AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND website IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE网址 {name:row.to}) MERGE (from)-[:网址]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:联系电话]->(to:PRE电话)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,tel AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND tel IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE电话 {name:toName}) MERGE (from)-[:联系电话]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:董秘电话]->(to:PRE电话)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,bsecretary_tel AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND bsecretary_tel IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE电话 {name:toName}) MERGE (from)-[:董秘电话]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:证券代表电话]->(to:PRE电话)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,security_man_tel AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND security_man_tel IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE电话 {name:toName}) MERGE (from)-[:证券代表电话]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:客服电话]->(to:PRE电话)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,service_tel AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND service_tel IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE电话 {name:toName}) MERGE (from)-[:客服电话]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:传真]->(to:PRE传真)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,fax AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND fax IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE传真 {name:toName}) MERGE (from)-[:传真]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:董秘传真]->(to:PRE传真)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,bsecretary_fax AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND bsecretary_fax IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE传真 {name:toName}) MERGE (from)-[:董秘传真]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:证券代表传真]->(to:PRE传真)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,security_man_fax AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND security_man_fax IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE传真 {name:toName}) MERGE (from)-[:证券代表传真]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:客服传真]->(to:PRE传真)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,service_fax AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND service_fax IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH REPLACE(olab.replace.regexp(row.name,\'[^0-9]\'),\' \',\'\') AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE传真 {name:toName}) MERGE (from)-[:客服传真]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:营业执照号码]->(to:PRE营业执照号码)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,biz_license_no AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND biz_license_no IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE营业执照号码 {name:row.to}) MERGE (from)-[:营业执照号码]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:国税登记号码]->(to:PRE国税登记号码)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,tax_register_no AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND tax_register_no IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE国税登记号码 {name:row.to}) MERGE (from)-[:国税登记号码]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:地税登记号码]->(to:PRE地税登记号码)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,land_register_no AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND land_register_no IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE地税登记号码 {name:row.to}) MERGE (from)-[:地税登记号码]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:公司注册号]->(to:PRE公司注册号)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,company_register_code AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND company_register_code IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE公司注册号 {name:row.to}) MERGE (from)-[:公司注册号]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:纳税人识别号]->(to:PRE纳税人识别号)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,taxpayer_number AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND taxpayer_number IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE纳税人识别号 {name:row.to}) MERGE (from)-[:纳税人识别号]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:交易代码]->(to:PRE交易代码)
- (from:PREPCODE)-[r:其它关联组织机构]->(to:PRE其它关联组织机构)
- (from:PREPCODE)-[r:邮编]->(to:PRE邮编)
- (from:PREPCODE)-[r:上市公司代码]->(to:PRE上市公司代码)
- (from:PREPCODE)-[r:组织机构代码]->(to:PRE组织机构代码)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,organization_code AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND organization_code IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE组织机构代码 {name:row.to}) MERGE (from)-[:组织机构代码]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:律师事务所]->(to:PRE其它关联组织机构)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,law_office AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND law_office IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE其它关联组织机构 {name:row.to}) MERGE (from)-[:律师事务所]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:会计师事务所]->(to:PRE其它关联组织机构)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,accounting_firm AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND accounting_firm IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE其它关联组织机构 {name:row.to}) MERGE (from)-[:会计师事务所]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:资产评估机构]->(to:PRE其它关联组织机构)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,asset_evaluation_agency AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND asset_evaluation_agency IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE其它关联组织机构 {name:row.to}) MERGE (from)-[:资产评估机构]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:法人代表]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,legal_person_repr AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND legal_person_repr IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:法人代表]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:总经理]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,general_manager AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND general_manager IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:总经理]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:律师]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,lawyer AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND lawyer IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:律师]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:会计师]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,accountant AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND accountant IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:会计师]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:评估师]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,valuer AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND valuer IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:评估师]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:基金管理人名称]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,invest_advisor_name AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND invest_advisor_name IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:基金管理人名称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:基金托管人名称]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,trustee_name AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND trustee_name IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:基金托管人名称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:其它负责人]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,other_manager AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND other_manager IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:其它负责人]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:联系人]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,contactman AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND contactman IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:联系人]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:董事长]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,chairman AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND chairman IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:董事长]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:董秘]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,bsecretary AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND bsecretary IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:董秘]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:证券股证事务代表]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,security_man AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND security_man IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:证券股证事务代表]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:董秘授权代表]->(to:PRE人物)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,auth_represent AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND auth_represent IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'MATCH (from:PREPCODE {name:row.from}),(to:PRE人物 {name:row.to}) MERGE (from)-[:董秘授权代表]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:公司简介]->(to:PRE公司简介)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,brief_intro_text AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND brief_intro_text IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.simhash(olab.string.matchCnEnRinse(row.to)) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE公司简介 {name:toName}) MERGE (from)-[:公司简介]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:主营业务]->(to:PRE主营业务)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,business_major AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND business_major IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.simhash(olab.string.matchCnEnRinse(row.to)) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE主营业务 {name:toName}) MERGE (from)-[:主营业务]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:公司英文简介]->(to:PRE公司英文简介)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,brief_intro_text_en AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND brief_intro_text_en IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.simhash(olab.string.matchCnEnRinse(row.to)) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE公司英文简介 {name:toName}) MERGE (from)-[:公司英文简介]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:经营范围]->(to:PRE经营范围)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,biz_scope AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND biz_scope IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.simhash(olab.string.matchCnEnRinse(row.to)) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE经营范围 {name:toName}) MERGE (from)-[:经营范围]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:经营范围英文]->(to:PRE经营范围英文)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,biz_scope_en AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND biz_scope_en IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH olab.simhash(olab.string.matchCnEnRinse(row.to)) AS toName,row MATCH (from:PREPCODE {name:row.from}),(to:PRE经营范围英文 {name:toName}) MERGE (from)-[:经营范围英文]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:曾用名]->(to:PRE曾用名)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,previous_name AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND previous_name IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH apoc.convert.fromJsonList(row.to) AS oldNameList,row.from AS fromName UNWIND oldNameList AS oldName WITH olab.string.matchCnEnRinse(oldName) AS toName,fromName MATCH (from:PREPCODE {name:fromName}),(to:PRE曾用名 {name:toName}) MERGE (from)-[:曾用名]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
- (from:PREPCODE)-[r:证券名称]->(to:PRE证券名称)
```
CALL apoc.periodic.iterate('CALL apoc.load.jdbc(\'jdbc:mysql://datalab-contentdb-dev.crkldnwly6ki.rds.cn-north-1.amazonaws.com.cn:3306/master_dev?user=dev&password=datalabgogo&useUnicode=true&characterEncoding=utf8&serverTimezone=UTC\', \'SELECT parent_pcode AS `from`,relevant_security AS `to` FROM MSTR_ORG_PRE_0 WHERE hisvalid=1 AND parent_pcode IS NOT NULL AND relevant_security IS NOT NULL AND hupdatetime>={hupdatetime}\')',
'WITH apoc.convert.fromJsonList(row.to) AS oldNameList,row.from AS fromName UNWIND oldNameList AS oldName WITH olab.string.matchCnEnRinse(oldName) AS toName,fromName MATCH (from:PREPCODE {name:fromName}),(to:PRE证券名称 {name:toName}) MERGE (from)-[:证券名称]->(to)', {parallel:false,batchSize:1000}) YIELD batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations
RETURN batches,total,timeTaken,committedOperations,failedOperations,failedBatches,retries,errorMessages,batch,operations;
```
## Spark相似性计算
### 关系权重分配
```
{
  "INT_ORG_AGGREGATION_WEIGHTINESS_THRESHOLD": 16,
  "ENDEMIASM_RELATIONSHIPS": [
    "纳税人识别号",
    "地税登记号码",
    "国税登记号码",
    "营业执照号码",
    "统一社会信用代码",
    "组织机构代码"
    "交易代码",
    "上市公司代码",
    "曾用名",
    "中文名称",
  ],
  "律师事务所": 1,
  "会计师事务所": 1,
  "资产评估机构": 1,
  "法人代表": 2,
  "总经理": 2,
  "律师": 1,
  "会计师": 1,
  "评估师": 1,
  "基金管理人名称": 1,
  "基金托管人名称": 1,
  "其它负责人": 1,
  "联系人": 1,
  "董事长": 2,
  "董秘": 1,
  "证券股证事务代表": 1,
  "董秘授权代表": 1,
  "纳税人识别号": -1,
  "公司注册号": -1,
  "地税登记号码": -1,
  "国税登记号码": -1,
  "营业执照号码": -1,
  "组织机构代码": -1,
  "上市公司代码":-1,
  "中文名称":-1,
  "曾用名":-1,
  "交易代码":-1,
  "传真": 3,
  "董秘传真": 1,
  "证券代表传真": 1,
  "客服传真": 1,
  "联系电话": 3,
  "董秘电话": 1,
  "证券代表电话": 1,
  "客服电话": 2,
  "网址": 4,
  "电子邮箱": 4,
  "董秘邮箱": 1,
  "证券代表电子邮箱": 1,
  "注册地址": 3,
  "注册地所在国家": 0,
  "注册所在省市": 1,
  "注册所在区县": 1,
  "注册地址邮编": 1,
  "所在地区": 0,
  "办公地址": 3,
  "联系地址": 2,
  "联系地址邮编": 1,
  "联系所在省市": 1,
  "省份": 0,
  "市县代码": 0,
  "市县": 1,
  "成立日期": 1,
  "存续起始日": 1,
  "存续截止日": 1,
  "统一社会信用代码": -1,
  "英文简称": 5,
  "英文名称": 5,
  "中文拼音简称": 5,
  "证券名称":5,
  "中文简称": 5,
  "相似简介": 1,
  "相似业务": 1,
  "相似名称": 1
}
```
### 阈值设置
- 随机测试和经验值得出
- 纳税人识别号/地税登记号码/国税登记号码/营业执照号码/统一社会信用代码/组织机构代码交易代码/上市公司代码/曾用名全称/全称相同的机构直接划分为同一家机构【相似度分值设置为理论无穷大】【为方便查询设置一个具体数值远大于各维度相似度计算得分】【暂定100000】

### 计算方式
```

```

### 计算结果保存到Elasticsearch
```

```

## 使用CYPHER查询某个公司主体的聚簇
使用阈值过滤Elasticsearch查询出同一家主体，通过pcode关联出数据网络
```

```

